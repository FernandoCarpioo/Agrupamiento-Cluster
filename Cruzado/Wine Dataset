import kagglehub
import os
import pandas as pd
import numpy as np
from sklearn.model_selection import KFold, cross_validate
from sklearn.linear_model import LinearRegression

path = kagglehub.dataset_download("yasserh/wine-quality-dataset")
print("Ruta del dataset:", path)

file_path = os.path.join(path, "WineQT.csv") 

datos = pd.read_csv(file_path)

X = datos.drop(columns=["quality"])  
y = datos["quality"]                 

modelo = LinearRegression()

kfold = KFold(n_splits=5, shuffle=True, random_state=42)

resultados = cross_validate(
    modelo, X, y, cv=kfold,
    scoring=('r2', 'neg_mean_squared_error', 'neg_mean_absolute_error'),
    return_train_score=True
)

#Resultados
print("\nR² por fold:", resultados['test_r2'])
print("R² promedio:", np.mean(resultados['test_r2']))

mse_promedio = -np.mean(resultados['test_neg_mean_squared_error'])
mae_promedio = -np.mean(resultados['test_neg_mean_absolute_error'])

print("MSE promedio:", mse_promedio)
print("MAE promedio:", mae_promedio)
